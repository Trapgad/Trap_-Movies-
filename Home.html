<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TRAP MOVIES | Home</title>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">
<style>
/* -------------------- BASE -------------------- */
body {
  margin: 0;
  font-family: 'Montserrat', sans-serif;
  background-color: #0d0d0d;
  color: #f1f1f1;
  transition: 0.3s;
}
body.modal-open { overflow: hidden; }

header {
  background: linear-gradient(90deg, #b30000, #2a0d2a);
  text-align: center;
  padding: 1.5rem;
  font-size: 2rem;
  font-weight: bold;
  letter-spacing: 2px;
  color: #fff;
  text-shadow: 1px 1px 3px #000;
}

/* -------------------- NAVIGATION -------------------- */
.nav-wrapper {
  position: relative;
  background: rgba(20,20,20,0.85);
  backdrop-filter: blur(12px);
  border-bottom: 2px solid #b30000;
  overflow: hidden;
}

nav {
  display: flex;
  overflow-x: auto;
  white-space: nowrap;
  gap: 2rem;
  padding: 0.8rem 2rem;
  scrollbar-width: thin;
  scrollbar-color: #b30000 transparent;
  scroll-behavior: smooth;
  scroll-snap-type: x mandatory;
}

nav::-webkit-scrollbar { height: 6px; }
nav::-webkit-scrollbar-track { background: transparent; }
nav::-webkit-scrollbar-thumb { background: #b30000; border-radius: 10px; }

nav a {
  display: flex;
  align-items: center;
  gap: 6px;
  text-decoration: none;
  color: #ccc;
  font-weight: 600;
  padding-bottom: 4px;
  scroll-snap-align: start;
  position: relative;
  transition: 0.3s;
}
nav a.active,
nav a:hover {
  color: #ff33ff;
}
nav a::after {
  content: '';
  position: absolute;
  bottom: 0;
  left: 0;
  width: 0;
  height: 3px;
  background: linear-gradient(to right, #b30000, #800080);
  border-radius: 3px;
  transition: 0.3s;
}
nav a:hover::after,
nav a.active::after {
  width: 100%;
}

/* Scroll buttons */
.scroll-btn {
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
  background: linear-gradient(to bottom, #b30000, #800080);
  border: none;
  color: white;
  font-size: 1.5rem;
  padding: 6px 12px;
  cursor: pointer;
  z-index: 10;
  border-radius: 50%;
  display: none;
}
.scroll-left { left: 5px; }
.scroll-right { right: 5px; }

/* Fade shadows */
.fade-left,
.fade-right {
  position: absolute;
  top: 0;
  width: 50px;
  height: 100%;
  pointer-events: none;
  z-index: 5;
}
.fade-left { left: 0; background: linear-gradient(to right, rgba(13,13,13,1), transparent); }
.fade-right { right: 0; background: linear-gradient(to left, rgba(13,13,13,1), transparent); }

/* -------------------- HERO -------------------- */
.hero {
  text-align: center;
  padding: 3rem 1rem;
  background: linear-gradient(to right, #1a001a, #0d0d0d);
  color: #ff33ff;
  font-size: 1.8rem;
  font-weight: bold;
  text-transform: uppercase;
}
.hero-buttons {
  margin-top: 20px;
  display: flex;
  justify-content: center;
  gap: 15px;
  flex-wrap: wrap;
}
button {
  padding: 12px 30px;
  font-size: 1rem;
  font-weight: bold;
  border-radius: 8px;
  cursor: pointer;
  border: none;
  transition: all 0.3s ease;
  letter-spacing: 1px;
  box-shadow: 0 4px 8px rgba(0,0,0,0.5);
}
.signin-btn { background: linear-gradient(45deg, #ff0033, #b30000); color: #fff; }
.signin-btn:hover { transform: translateY(-3px); box-shadow: 0 6px 12px rgba(255,0,51,0.7); }
.signup-btn { background: linear-gradient(45deg, #800080, #b30000); color: #fff; }
.signup-btn:hover { transform: translateY(-3px); box-shadow: 0 6px 12px rgba(128,0,128,0.7); }
.logout-btn { background: linear-gradient(45deg, #ff33ff, #b30000); color: #fff; }
.logout-btn:hover { transform: translateY(-3px); box-shadow: 0 6px 12px rgba(255,51,255,0.7); }

/* -------------------- SEARCH -------------------- */
.search-bar { display: flex; justify-content: center; margin: 1.5rem 0; }
.search-bar input {
  width: 70%;
  max-width: 400px;
  padding: 0.8rem;
  border: 2px solid #b30000;
  border-radius: 25px;
  background: #111;
  color: white;
  font-size: 1rem;
  text-align: center;
  outline: none;
}

/* -------------------- MOVIES -------------------- */
.movies {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
  gap: 1.2rem;
  padding: 1.5rem;
}
.movie-card {
  background: #1f1f1f;
  border-radius: 10px;
  overflow: hidden;
  text-align: center;
  box-shadow: 0 0 12px rgba(179,0,0,0.5);
  transition: transform 0.3s, box-shadow 0.3s;
  cursor: pointer;
}
.movie-card:hover {
  transform: scale(1.05);
  box-shadow: 0 0 20px rgba(255,0,128,0.7);
}
.movie-card img { width: 100%; aspect-ratio: 2/3; object-fit: cover; }
.movie-card h3 { font-size: 1rem; margin: 0.5rem 0; color: #fff; }

/* -------------------- FOOTER -------------------- */
footer {
  background: #1a1a1a;
  color: #aaa;
  text-align: center;
  padding: 1rem;
  font-size: 0.9rem;
  border-top: 2px solid #b30000;
}

/* -------------------- MODAL -------------------- */
.modal {
  display: none;
  position: fixed;
  z-index: 10;
  left: 0; top: 0;
  width: 100%; height: 100%;
  background: rgba(10,10,10,0.95);
  justify-content: center; align-items: center;
}
.modal-content { position: relative; width: 80%; max-width: 800px; }
.modal-content iframe { width: 100%; aspect-ratio: 16/9; border-radius: 8px; }
.close {
  position: absolute; top: -30px; right: 0;
  font-size: 2rem; color: #fff; cursor: pointer;
}
.close:hover { color: #ff33ff; }
</style>
</head>
<body>

<header>üé¨ TRAP MOVIES</header>

<!-- -------------------- NAVIGATION -------------------- -->
<div class="nav-wrapper">
  <div class="fade-left"></div>
  <button class="scroll-btn scroll-left">&#10094;</button>
  <nav id="tabNav">
    <a href="index.html" class="active">üè† Home</a>
    <a href="Movies.html">üé¨ Movies</a>
    <a href="Series.html">üì∫ Series</a>
    <a href="About.html">‚ÑπÔ∏è About</a>
    <a href="Contact.html">‚úâÔ∏è Contact</a>
    <a href="Account Details.html">üë§ Account</a>
  </nav>
  <button class="scroll-btn scroll-right">&#10095;</button>
  <div class="fade-right"></div>
</div>

<section class="hero">
  <h2>Your Gateway to the Latest Movies & Series</h2>
  <div class="hero-buttons">
    <a href="signin.html"><button class="signin-btn">Sign In</button></a>
    <a href="signup.html"><button class="signup-btn">Sign Up</button></a>
    <button id="logoutBtn" class="logout-btn" style="display:none;">Sign Out</button>
  </div>
</section>

<div class="search-bar">
  <input type="text" id="searchInput" placeholder="Search for movies...">
</div>

<section class="movies" id="movieContainer"></section>

<!-- Trailer Modal -->
<div id="trailerModal" class="modal">
  <div class="modal-content">
    <span class="close">&times;</span>
    <iframe id="trailerFrame" src="" frameborder="0" allowfullscreen></iframe>
  </div>
</div>

<footer>¬© 2025 TRAP MOVIES ‚Äî Created by TRAP GAD üî•</footer>

<!-- -------------------- SCRIPTS -------------------- -->
<script>
// NAV SCROLL BUTTONS
const nav = document.getElementById("tabNav");
const btnLeft = document.querySelector(".scroll-left");
const btnRight = document.querySelector(".scroll-right");
const scrollAmount = 150;
btnLeft.onclick = () => nav.scrollBy({ left: -scrollAmount, behavior: "smooth" });
btnRight.onclick = () => nav.scrollBy({ left: scrollAmount, behavior: "smooth" });
function updateButtons() {
  if (nav.scrollWidth > nav.clientWidth) { btnLeft.style.display="block"; btnRight.style.display="block"; }
  else { btnLeft.style.display="none"; btnRight.style.display="none"; }
}
window.addEventListener("load", updateButtons);
window.addEventListener("resize", updateButtons);

const TOKEN = "eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiIxN2ExODM0ZTI3MzMyMGVlZjhhMmEzNmIzOGExMTk2NCIsIm5iZiI6MTc2MDE5MDU2OC4wOTQsInN1YiI6IjY4ZWE2MDY4ZmJjYjQxOTVlYjlmZDg2ZCIsInNjb3BlcyI6WyJhcGlfcmVhZCJdLCJ2ZXJzaW9uIjoxfQ.iFV2N9KUPakJb_HWWY3eZbB3cUq_gMhM1H9hcnEWD7Q";
const IMG_PATH = "https://image.tmdb.org/t/p/w500";
const movieContainer = document.getElementById("movieContainer");
const searchInput = document.getElementById("searchInput");

async function getMovies(url="https://api.themoviedb.org/3/trending/movie/week"){
  try{
    const res = await fetch(url, { headers:{Authorization:`Bearer ${TOKEN}`} });
    const data = await res.json();
    if(!data.results || data.results.length===0) throw new Error("No movies found.");
    displayMovies(data.results);
  } catch(err){
    console.error(err);
    movieContainer.innerHTML=`<p style="text-align:center;color:#ff33ff;">Failed to load movies üò¢<br>Check your TMDB token.</p>`;
  }
}

function displayMovies(movies){
  movieContainer.innerHTML="";
  movies.forEach(movie=>{
    const card=document.createElement("div");
    card.classList.add("movie-card");
    card.innerHTML=`<img src="${movie.poster_path?IMG_PATH+movie.poster_path:'https://via.placeholder.com/500x750?text=No+Image'}" alt="${movie.title}">
    <h3>${movie.title}</h3>`;
    card.addEventListener("click",()=>openTrailer(movie.id));
    movieContainer.appendChild(card);
  });
}

// Search with debounce
let debounceTimer;
searchInput.addEventListener("keyup",(e)=>{
  clearTimeout(debounceTimer);
  debounceTimer=setTimeout(async()=>{
    const query=e.target.value.trim();
    if(query.length>0){
      try{
        const res = await fetch(`https://api.themoviedb.org/3/search/movie?query=${query}`, { headers:{Authorization:`Bearer ${TOKEN}`} });
        const data = await res.json();
        displayMovies(data.results || []);
      }catch(err){
        console.error(err);
        movieContainer.innerHTML=`<p style="text-align:center;color:#ff33ff;">Search failed üò¢</p>`;
      }
    } else getMovies();
  },500);
});

// Trailer Modal
async function openTrailer(movieId){
  try{
    const res = await fetch(`https://api.themoviedb.org/3/movie/${movieId}/videos`, { headers:{Authorization:`Bearer ${TOKEN}`} });
    const data = await res.json();
    const trailer = data.results.find(v=>v.type==="Trailer" && v.site==="YouTube");
    if(trailer){
      document.getElementById("trailerFrame").src=`https://www.youtube.com/embed/${trailer.key}?autoplay=1`;
      document.getElementById("trailerModal").style.display="flex";
      document.body.classList.add("modal-open");
    }
  }catch(err){console.error(err);}
}
document.querySelector(".close").onclick=closeModal;
window.onclick=(e)=>{if(e.target===document.getElementById("trailerModal")) closeModal();}
window.addEventListener("keydown",e=>{if(e.key==="Escape") closeModal();});
function closeModal(){
  document.getElementById("trailerModal").style.display="none";
  document.getElementById("trailerFrame").src="";
  document.body.classList.remove("modal-open");
}

// Load movies
getMovies();
</script>

<!-- -------------------- FIREBASE AUTH -------------------- -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js";
import { getAuth, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-auth.js";

const firebaseConfig = {
  apiKey: "AIzaSyBLHlSlMPvwSS5MB8JqG2JB1R-ANIopQZU",
  authDomain: "trap-270792.firebaseapp.com",
  projectId: "trap-270792",
  storageBucket: "trap-270792.firebasestorage.app",
  messagingSenderId: "248838190395",
  appId: "1:248838190395:web:0dd11c0e4427f79470331e",
  measurementId: "G-PG6GXVVKL9"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const logoutBtn = document.getElementById("logoutBtn");

function updateAuthButtons(user){
  const buttons = document.querySelectorAll("a[href='signin.html'], a[href='signup.html']");
  if(user){ buttons.forEach(btn=>btn.style.display="none"); logoutBtn.style.display="inline-block"; }
  else{ buttons.forEach(btn=>btn.style.display="inline-block"); logoutBtn.style.display="none"; }
}

onAuthStateChanged(auth,(user)=>updateAuthButtons(user));

logoutBtn.onclick=()=>{ 
  signOut(auth)
    .then(()=>{ alert("Signed Out Successfully!"); window.location.href="signin.html"; })
    .catch(err=>alert(err.message)); 
}
</script>

</body>
</html>